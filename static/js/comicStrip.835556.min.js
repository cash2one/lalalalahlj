jQuery(".info-text-wrap p.title").mouseenter(function(){var e=52;var t=jQuery(this).height();if(t>e){jQuery(this).parent().stop().animate({height:t+"px"})}});jQuery(".info-text-wrap").mouseleave(function(){var e=52;jQuery(this).stop().animate({height:e+"px"})});var curIndex=0;var photoThumbLeft=0;var loadedImgs=[];jQuery("#photo_thumb li").each(function(e,t){jQuery(t).click(function(){jQuery("#photo_thumb li").removeClass("cur").eq(e).addClass("cur");show(e);curIndex=e})});var THUMBNAIL_WIDTH=96;var THUMBNAIL_COUNT=9;var THUMBNAIL_PAGE_WIDTH=THUMBNAIL_WIDTH*THUMBNAIL_COUNT;function show(e){var t=parseInt(jQuery(".photoShow.show").attr("data-idx"),10),r=jQuery(".photoShow").length-1;var o;if("prev"===e){o=t===0?r:t-1}else if("next"===e){o=r===t?0:t+1}else if(typeof e==="number"){o=e}showCurr(o);photoThumbLeft=-(o-4)*THUMBNAIL_WIDTH;if(photoThumbLeft>0)photoThumbLeft=0;jQuery("#photo_thumb").animate({left:photoThumbLeft+"px"});showBigPic(t,o);curIndex=o}jQuery("#photo_prev").click(function(){show("prev")});jQuery("#photo_next").click(function(){show("next")});var rfocusable=/^(?:button|input|object|select|textarea)$/i;jQuery(document).on("keydown",function(e){if(!rfocusable.test(e.target.nodeName)){switch(e.keyCode){case 37:show("prev");break;case 39:show("next");break}}});function showCurr(e){jQuery("#photo_thumb li").each(function(t,r){jQuery("#photo_thumb li").removeClass("cur").eq(e).addClass("cur")})}function showBigPic(e,t){jQuery(".photoShow[data-idx="+e+"]").removeClass("show");var r=jQuery(".photoShow[data-idx="+t+"]"),o=r.find("img"),a=o.attr("data-src");targetImgId=o.attr("data-id");var i=jQuery(".photoGallery");var u=jQuery.parseJSON(o.attr("data-size"));if(!o.data("loaded")){o.on("load",function(){u=u||{w:o.width(),h:o.height()};var e=jQuery(window).height()-152;var t=e*u.w/u.h;var i=t<=960?960:t;i=i>1200?1200:i;var h=i*u.h/u.w;jQuery(".photoGallery").height(h);jQuery(".photoGallery").width(i);jQuery("#topTitle").width(i);jQuery("#galleryBox").width(i);jQuery("#comment").width(i);r.addClass("show");o.data("loaded",true);loadedImgs.push(a)}).attr("src",a)}else{o.attr("src",a);r.addClass("show")}var h=location.href.split("#")[0];document.location.href=h+"#p="+targetImgId;jQuery(".vieworigin").attr("href",a);var n=t===jQuery(".photoShow").length-1?null:t+1;if(n){var l=jQuery(".photoShow[data-idx="+n+"] img").attr("data-src");if(-1===jQuery.inArray(l,loadedImgs)){jQuery("<img>").on("load",function(){loadedImgs.push(l)}).attr("src",l)}}try{vjEventTrack();neteaseTracker()}catch(s){}}var make_gallery=function(e,t,r,o,a){var e=jQuery(e);var i=jQuery("> li",e).length,u=jQuery("> li:nth-child(2)",e).outerWidth(true),h=jQuery("> li.cur",e).outerWidth(true),n=u*t;if(a==1){var l=u*(i-1)+h}else if(a==0){var l=u*i}e.width(l);var s=0;var f=function(t){if(t>0)newLeft=Math.floor((photoThumbLeft-1)/n)*n;else if(t<0)newLeft=Math.ceil((photoThumbLeft+1)/n)*n;if(newLeft>0)newLeft=0;if(newLeft<=-l)newLeft=0;e.stop().animate({left:newLeft+"px"});photoThumbLeft=newLeft};jQuery(r).click(function(){f(-1);return false});jQuery(o).click(function(){f(1);return false})};make_gallery(jQuery("#gallery"),4,"#fn_focus_prev_next .prev","#fn_focus_prev_next .next",0);make_gallery(jQuery("#photo_thumb"),9,"#photo_ctrl .prev","#photo_ctrl .next",1);var imgInfoJson=jQuery("#gallery-data").val();var currIdImgShow=jQuery.parseJSON(imgInfoJson);var getImageIndexFromUrl=function(){var e=location.href.split("#")[1];if(typeof e=="undefined")return 0;var t=e.split("=")[1];var r=currIdImgShow[t];if(typeof r=="undefined")return 0;var o=parseInt(r.id,10);if(o>0)return o;return 0};var index=getImageIndexFromUrl();show(index);var resizeTimer=null;jQuery(window).on("resize",function(){if(resizeTimer)clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){var e=jQuery(".photoShow.show"),t=jQuery.parseJSON(e.find("img").attr("data-size"));if(t){var r=jQuery(window).height()-152;var o=r*t.w/t.h;var a=o<=960?960:o;a=a>1200?1200:a;var i=a*t.h/t.w;jQuery(".photoGallery").height(i);jQuery(".photoGallery").width(a);jQuery("#topTitle").width(a);jQuery("#galleryBox").width(a);jQuery("#comment").width(a)}},100)});